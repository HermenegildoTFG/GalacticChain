const HDWalletProvider = require('truffle-hdwallet-provider');
const Web3 = require('web3');



const provider = new HDWalletProvider(

  'arctic economy dumb identify retire forward oven hollow proof version outer have',
  'https://rinkeby.infura.io/v3/2c97035d3bc94e649552be9572fbfa08'//te lo proporciona infura al crear un proyecto, dependiendo de la red te da un link u otro, en este caso se ha elegido rinkeby
);

const address = '0x206E7F9c93432Be5F6B672A660f9dA0Bc731d29e';
const abi =
[{"constant":false,"inputs":[{"name":"idAc","type":"uint256"},{"name":"signature","type":"bytes32"}],"name":"signAccident","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[{"name":"idAddress","type":"address"}],"name":"getData","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"idAc","type":"uint256"}],"name":"isSigned","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"idAc","type":"uint256"}],"name":"giveWork","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[],"name":"kill","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"a","type":"uint256"}],"name":"deleteAlert","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[],"name":"rewardAccident","outputs":[{"name":"","type":"bool"}],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[{"name":"i","type":"uint256"}],"name":"getAccident","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"idAc","type":"uint256"}],"name":"getAccidentCreator","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"a","type":"uint256"}],"name":"getAlertCreator","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"a","type":"uint256"}],"name":"verifyAlert","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[{"name":"a","type":"address"}],"name":"sendJackpot","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"a","type":"uint256"}],"name":"getAlert","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"idAc","type":"uint256"}],"name":"addAssistance","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[{"name":"idAc","type":"uint256"}],"name":"givesAssistance","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"idAc","type":"uint256"}],"name":"getAccidentPrice","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"info","type":"bytes32"},{"name":"signature","type":"bytes32"}],"name":"newAlert","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[],"name":"getAlertsNum","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getNumOfAccidents","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"idAc","type":"uint256"}],"name":"getAssistanceList","outputs":[{"name":"","type":"address[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"a","type":"uint256"}],"name":"getAlertPrice","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"idAc","type":"uint256"}],"name":"getLostList","outputs":[{"name":"","type":"address[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"homework","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"idAc","type":"uint256"},{"name":"idAddress","type":"address"}],"name":"newLost","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"inputs":[{"name":"database","type":"address"},{"name":"_alertManager","type":"address"}],"payable":true,"stateMutability":"payable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_info","type":"bytes32"}],"name":"NewAccident","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_deleted","type":"uint256"}],"name":"DeletedAccident","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_idAc","type":"uint256"}],"name":"NewLost","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_idAc","type":"uint256"}],"name":"FoundLost","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_idAc","type":"uint256"},{"indexed":false,"name":"_idAssitance","type":"address"}],"name":"NewAssistance","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_idAc","type":"uint256"},{"indexed":false,"name":"_addidAssitance","type":"address"}],"name":"DeleteAssistance","type":"event"},{"anonymous":false,"inputs":[],"name":"ChangedAlerts","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_idAc","type":"uint256"}],"name":"SignedAccident","type":"event"}];


const web3 = new Web3(provider);

const use = async () => {

    const server = new web3.eth.Contract(abi,address);
    var accounts = await web3.eth.getAccounts();
    console.log(accounts[0]);
    var a = await server.methods.getAlertsNum().call({from: accounts[0]});
    a = parseInt(a);
    await server.methods.kill().send({from: accounts[0]});
    console.log(a);
}
use();
